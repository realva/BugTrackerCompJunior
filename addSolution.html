<!--Comp Júnior/Grupo 2-->
<!--Projeto a ser realizado para o PS 2016.1/Etapa 3-->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" />
    <title>CompJúnior BugTracker | Cadastrar Projeto</title>
    <link rel="icon" href="imagens/joaninha.png">
    <meta name="description" content="Controlador de erros da CompJr">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!--Referência para a folha de estilo base a ser usada-->
    <link href="css/css.css" rel="stylesheet">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/js.js"></script>
    <script type="text/javascript" src="js/detalhes.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <link href="css/sweetalert2.css" rel="stylesheet">
    <link rel="stylesheet" href="css/animate.css">
    <script src="js/wow.js"></script>
    <script>
        new WOW().init();
    </script>

</head>

<body>
    <!-- ALL-PAGE -->
    <div id="myContain" class="body">
        <!-- HEADER -->
        <header id="myHeader" class="myHeader">
            <nav class="navig">
                <!-- BRAND e MENU-MOBILE -->
                <div class="mobile-brand">
                    <button id="navi-btn" onclick="slidetoggle()" type="button" class="navbar-toggle collapsed menu-pad" data-toggle="collapse" data-target="#menu-nav" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>

                    </button>

                    <section id="navi-slide">
                        <ul class="navi">
                            <li><a href="index.html" class="link-menu">Home</a></li>
                            <li class="dropdown">
                                <a href="#" class="flex-a dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <p>Cadastro</p>
                                    <span class="caret"></span>
                                </a>
                                <ul class="">
                                    <li><a href="addError.html">Erros</a></li>
                                    <li><a href="addProject.html">Projetos</a></li>
                                </ul>
                            </li>
                            <li><a href="search.html">Buscar</a></li>
                        </ul>

                    </section>


                    <a class="brand" href="index.html">
                        Compjunior
                    </a>
                </div>
                <!-- BRAND e MENU-MOBILE -->

                <!-- MENU-DESKTOP -->
                <div class="collapse navbar-collapse" id="munu-nav">
                    <ul class="navigator">
                        <li><a href="index.html" class="link-menu">Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="flex-a dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                <p>Cadastro</p>
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu a-cores">
                                <li><a href="addError.html">Erros</a></li>
                                <li><a href="addProject.html">Projetos</a></li>
                            </ul>
                        </li>
                        <li><a href="search.html">Buscar</a></li>
                    </ul>
                </div>
                <!-- MENU-DESKTOP FIM -->
            </nav>
        </header>
        <!-- HEADER-FIM -->

        <!-- CONTEUDO -->
        <main id="myMain" class="myMain wow fadeIn">

            <div class="conte-detalhes">
                <div class="cont-header">

                    <h1 id="titulo" class="intro-text text-center">Cadastro de Solução</h1>
                </div>

                <div class="cont-down-header">
                    <div class="">
                        <div class="hpanel-group" id="accordion" role="tablist" aria-multiselectable="true">

                            <div class="hpanel hpanel-default">
                                <div class="hpanel-heading" role="tab" id="headingOne">
                                    <h4 class="hpanel-title">
					<a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
						<i class="more-less glyphicon glyphicon-plus"></i>
						Descrição do Erro
					</a>
				</h4>
                                </div>
                                <div id="collapseOne" class="hpanel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                                    <div class="hpanel-body">
                                        <textarea class="form-control" rows="5" id="descricaoErro" disabled></textarea>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- panel-group -->
                    </div>
                    <div class="col-sm-12 space">
                        <label for="nameError" class="control-label">Nome do Erro</label>
                        <input type="text" name="nomeErro" id="nomeErro" class="form-control" placeholder="Erro de Interface" disabled>

                    </div>
                    <div class="hpanel hpanel-default">
                        <div class="hpanel-heading" role="tab" id="headingTwo">
                            <h4 class="hpanel-title">
					<a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
						<i class="more-less glyphicon glyphicon-plus"></i>
						Detalhes do Erro
					</a>
				</h4>
                        </div>
                        <div id="collapseTwo" class="hpanel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                            <div class="hpanel-body">
                                <div class="align">
                                    <div class="col-sm-12 space">
                                        <label>Projeto:</label>
                                        <input type="text" name="nomeProjeto" id="nomeProjeto" class="form-control" placeholder="SETI" disabled>
                                    </div>
                                    <div class="col-sm-12 space">
                                        <label>Tipo:</label>
                                        <input type="text" name="tipoErro" id="tipoErro" class="form-control" placeholder="Erro de Usabilidade" disabled>
                                    </div>
                                    <div class="col-sm-12 space">
                                        <label>Data:</label>
                                        <input type="text" name="dataErro" id="dataErro" class="form-control" placeholder="Date" onfocus="(this.type='date')" autofocus disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>


                <div class="cont-cont">
                    <div class="col-sm-12">
                        <form role="form" name="solutionform" id="solutionform">
                            <div class="form-group">
                                <label for="soluc" class="fullsc control-label">
                                    <div>
                                        <h6 class="recoil">Solução do Erro</h6>
                                    </div>
                                </label>
                                <textarea name="solucao" id="solucao" class="form-control" rows="6"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="dev" class="control-label">Desenvolvedor</label>
                                <select class="form-control" name="dev" id="dev">
                                    <option disabled selected value> Selecione a plataforma </option>
                                    <option>Matheus Nogueira</option>
                                    <option>Lucas de Paula</option>
                                    <option>Arlen Mateus Mendes</option>
                                    <option>Lucas Lopes Garcia</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <button type="button" class="btn btn-primary rp " onclick="enviar()">Cadastrar</button>
                                <button type="button" class="btn btn-primary rp " onclick="window.location.href='detalhesErro.html?id='+query().id">Cancelar</button>
                            </div>

                        </form>
                    </div>


                </div>
            </div>
        </main>
        <!-- CONTEUDO FIM -->

        <!-- FOOTER -->
        <footer id="myFooter" class="myFooter">
            <a href="http://www.compjunior.com.br/new2015/">CompJr</a>
            <p>Desenvolvido com <span class="heart">♥</span> pela Comp Junior.</p>
        </footer>
        <!-- FOOTER FIM -->
    </div>
    <!-- ALL-PAGE FIM -->
    <script type="text/javascript" src="js/bootstrapValidator.js"></script>
    <script type="text/javascript" src="js/validarFormSolution.js"></script>
    <script type="text/javascript" src="js/sweetalert2.min.js"></script>
    <script>
        function enviar() {

            var dev = $("#dev").val(); // nome do desenvolvedor que irá solucionar o erro.
            var solucao = $("#solucao").val(); // descricao da solucao do erro.

            if (dev != "" && solucao != "") {

                // requisicao via AJAX
                $.ajax({

                    type: 'post',
                    data: {
                        dev: dev,
                        solucao: solucao,
                        id: query().id
                    },
                    url: 'php/bdCadastrarSolucao.php',

                    success: function (data) {

                        swal({
                            title: 'A solução encontrada por ' + dev + ' foi cadastrada com sucesso',
                            //text: 'Sucesso',
                            type: 'success',
                            confirmButtonColor: '#3085d6',
                            confirmButtonText: 'OK'
                        }, function () {
                            window.location.reload();
                        });
                    },
                    error: function (xhr, status, error) {

                        swal({
                            title: 'A solução não pode ser cadastrada',
                            text: xhr.responseText,
                            type: 'error',
                            confirmButtonColor: '#3085d6',
                            confirmButtonText: 'OK'
                        });
                    }

                });
            } else {
                $("#solutionform").submit(); // tenta o submit no form, com isso a validacao de campo é chamada automaticamente
            }
        }
    </script>
    <script>
        var acc = document.getElementsByClassName("accordion");
        var i;
        for (i = 0; i < acc.length; i++) {
            acc[i].onclick = function () {
                this.classList.toggle("active");
                this.nextElementSibling.classList.toggle("show");
            }
        }
    </script>
    <script>
        $.getJSON("php/buscarDetalhes.php?id=" + query().id, null, function (data) {
            $("#descricaoErro").val(data.descricao);
            $("#nomeErro").val(data.nomeErro);
            $("#nomeProjeto").val(data.nomeProjeto);
            $("#tipoErro").val(data.tipo);
            $("#dataErro").val(data.data);

        });

        function toggleIcon(e) {
            $(e.target)
                .prev('.hpanel-heading')
                .find(".more-less")
                .toggleClass('glyphicon-plus glyphicon-minus');
        }
        $('.hpanel-group').on('hidden.bs.collapse', toggleIcon);
        $('.hpanel-group').on('shown.bs.collapse', toggleIcon);
    </script>
</body>

</html>