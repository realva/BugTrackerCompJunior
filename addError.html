<!--Comp Júnior/Grupo 2-->
<!--Projeto a ser realizado para o PS 2016.1/Etapa 3-->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" />
    <title>CompJúnior BugTracker | Cadastrar Erro</title>
    <link rel="icon" href="imagens/joaninha.png">
    <meta name="description" content="Controlador de erros da CompJr">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!--Referência para a folha de estilo base a ser usada-->
    <link href="css/css.css" rel="stylesheet">
    <script type="text/javascript" src="js/js.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <!--Referência para o Sweetalert 2-->
    <link href="css/sweetalert2.css" rel="stylesheet">
    <link rel="stylesheet" href="css/animate.css">
    <script src="js/wow.js"></script>
    <script>
        new WOW().init();
    </script>

</head>

<body>

    <!-- ALL-PAGE -->
    <div id="myContain" class="body">
        <!-- HEADER -->
        <header id="myHeader" class="myHeader">
            <nav class="navig">
                <!-- BRAND e MENU-MOBILE -->
                <div class="mobile-brand">
                    <button id="navi-btn" onclick="slidetoggle()" type="button" class="navbar-toggle collapsed menu-pad" data-toggle="collapse" data-target="#menu-nav" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>

                    </button>

                    <section id="navi-slide">
                        <ul class="navi">
                            <li><a href="index.html" class="link-menu">Home</a></li>
                            <li class="dropdown">
                                <a href="#" class="flex-a dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <p>Cadastro</p>
                                    <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu a-cores">
                                    <li><a href="addError.html">Erros</a></li>
                                    <li><a href="addProject.html">Projetos</a></li>
                                </ul>
                            </li>
                            <li><a href="search.html">Buscar</a></li>
                        </ul>

                    </section>


                    <a class="brand" href="index.html">
                        Compjunior
                    </a>
                </div>
                <!-- BRAND e MENU-MOBILE -->

                <!-- MENU-DESKTOP -->
                <div class="collapse navbar-collapse" id="munu-nav">
                    <ul class="navigator">
                        <li><a href="index.html" class="link-menu">Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="flex-a dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                <p>Cadastro</p>
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu a-cores">
                                <li><a href="addError.html">Erros</a></li>
                                <li><a href="addProject.html">Projetos</a></li>
                            </ul>
                        </li>
                        <li><a href="search.html">Buscar</a></li>
                    </ul>
                </div>
                <!-- MENU-DESKTOP FIM -->
            </nav>
        </header>
        <!-- HEADER-FIM -->

        <!-- CONTEUDO -->
        <main id="myMain" class="myMain wow  fadeIn">
            <section id="sectionCadastro" class="container-fluid">
                <h2 class="intro-text text-center">
               Cadastrar Erro
            </h2>

                <form role="errorform" name="errorform" id="errorform">
                    <div class="row">
                        <!--Insere o nome do erro-->
                        <div class="form-group col-lg-12">
                            <label for="nameError" class="control-label">Nome do Erro</label>
                            <input type="text" name="nameError" id="nameError" class="form-control">
                        </div>
                        <!--Selecionar o tipo do erro-->
                        <div class="form-group col-lg-12">
                            <label for="typeError" class="control-label">Tipo de Erro</label>
                            <select class="form-control" name="typeError" id="typeError">
                                <option disabled selected value> Selecione o tipo do erro </option>
                                <option>Interface</option>
                                <option>Erro de lógica</option>
                                <option>Erro de compilação</option>
                                <option>Erro de execução</option>
                                <option>Erro de footer</option>
                            </select>
                        </div>
                        <!--Selecionar o tipo de projeto em que o erro está vinculado-->
                        <div class="form-group col-lg-12">
                            <label for="errorProject" class="control-label">Projeto</label>
                            <select class="form-control" name="errorProject" id="errorProject">
                                <option disabled selected value> Selecione o projeto </option>
                                <option>Comp Android</option>
                                <option>Comp Web</option>
                                <option>Fórum de Química</option>
                                <option>Ponto eletrônico Comp</option>
                            </select>
                        </div>
                        <!--Faz uma breve descrição a cerca do erro-->
                        <div class="clearfix"></div>
                        <div class="form-group col-lg-12">
                            <label for="mensagemErro" class="control-label">Descrição do Erro</label>
                            <textarea class="form-control" rows="6" name="mensagemErro" id="mensagemErro"></textarea>
                        </div>
                        <div class="form-group col-lg-12">
                            <button type="button" class="btn btn-primary rp" onclick="enviar()">Cadastrar</button>
                            <button type="button" class="btn btn-primary rp " onclick="window.location.href='index.html'">Cancelar</button>
                        </div>
                    </div>

                </form>
            </section>
        </main>
        <!-- CONTEUDO FIM -->

        <!-- FOOTER -->
        <footer id="myFooter" class="myFooter">
            <a href="http://www.compjunior.com.br/new2015/">CompJr</a>
            <p>Desenvolvido com <span class="heart">♥</span> pela Comp Junior.</p>
        </footer>
        <!-- FOOTER FIM -->
    </div>
    <!-- ALL-PAGE FIM -->

    <!-- SCRIPT -->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/bootstrapValidator.js"></script>
    <script type="text/javascript" src="js/validarFormError.js"></script>
    <script type="text/javascript" src="js/sweetalert2.min.js"></script>
    <script type="text/javascript" src="js/extrairNomes.js"></script>
    <script type="text/javascript">
        extrairNomes("#errorProject")
    </script>
    <script>
        function enviar() {

            var nomeErro = $("#nameError").val(); // nome do erro
            var tipoErro = $("#typeError").val(); // tipo do erro
            var erroProjeto = $("#errorProject").val(); // projeto no qual o erro está vinculado.
            var mensagemErro = $("#mensagemErro").val(); // descricao do erro

            if (nomeErro != "" && tipoErro != "" && erroProjeto != "" && mensagemErro != "") {

                // requisicao via AJAX
                $.ajax({

                    type: 'post',
                    data: {
                        nomeErro: nomeErro,
                        tipoErro: tipoErro,
                        erroProjeto: erroProjeto,
                        mensagemErro: mensagemErro
                    },
                    url: 'php/bdCadastrarErro.php',

                    success: function (data) {

                        swal({
                            title: 'O erro ' + nomeErro + ' foi cadastrado com sucesso',
                            //text: 'Sucesso',
                            type: 'success',
                            confirmButtonColor: '#3085d6',
                            confirmButtonText: 'OK'
                        }, function () {
                            window.location.reload();
                        });
                    },
                    error: function (xhr, status, error) {

                        swal({
                            title: 'O erro não pode ser cadastrado',
                            text: xhr.responseText,
                            type: 'error',
                            confirmButtonColor: '#3085d6',
                            confirmButtonText: 'OK'
                        });
                    }

                });
            } else {
                $("#errorform").submit(); // tenta o submit no form, com isso a validacao de campo é chamada automaticamente
            }
        }
    </script>

</body>

</html>